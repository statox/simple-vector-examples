import"./DsnmJJEf.js";import{o as se,a as B}from"./CVJGeIlM.js";import{e as K,b as ne,s as H,h as D,af as ie,a as le,C as E,a6 as oe,r as fe,H as ue,c as O,d as R,k,ag as de,ah as ve,f as U,i as ce,g as he,ai as _e,B as ge,aj as W,ak as Q,al as me,am as we,j,p as xe,an as ye,ao as Ee,ap as Y,aq as $,ar as Te,as as Ae,at as Ie,au as Me,a4 as Ce,S as be,l as p,V as F,m as L,X as De,T as G,Y as z,Z as q,F as Ve,_ as Ne,W as Se}from"./DPwOY9Ev.js";import{P as ke,V as Z,s as J}from"./COKwq80w.js";function qe(d,t,r){for(var o=d.items,v=[],_=t.length,h=0;h<_;h++)Ae(t[h].e,v,!0);var w=_>0&&v.length===0&&r!==null;if(w){var y=r.parentNode;Ie(y),y.append(r),o.clear(),C(d,t[0].prev,t[_-1].next)}Me(v,()=>{for(var m=0;m<_;m++){var x=t[m];w||(o.delete(x.k),C(d,x.prev,x.next)),$(x.e,!w)}})}function ze(d,t,r,o,v,_=null){var h=d,w={flags:t,items:new Map,first:null};{var y=d;h=D?H(ie(y)):y.appendChild(K())}D&&le();var m=null,x=!1,M=new Map,i=oe(()=>{var a=r();return me(a)?a:a==null?[]:Q(a)}),g,f;function e(){He(f,g,w,M,h,v,t,o,r),_!==null&&(g.length===0?m?j(m):m=U(()=>_(h)):m!==null&&xe(m,()=>{m=null}))}ne(()=>{f??=Ce,g=E(i);var a=g.length;if(x&&a===0)return;x=a===0;let l=!1;if(D){var s=fe(h)===ue;s!==(a===0)&&(h=O(),H(h),R(!1),l=!0)}if(D){for(var n=null,c,u=0;u<a;u++){if(k.nodeType===de&&k.data===ve){h=k,l=!0,R(!1);break}var A=g[u],T=o(A,u);c=X(k,w,n,null,A,T,u,v,t,r),w.items.set(T,c),n=c}a>0&&H(O())}if(D)a===0&&_&&(m=U(()=>_(h)));else if(ce()){var b=new Set,I=he;for(u=0;u<a;u+=1){A=g[u],T=o(A,u);var V=w.items.get(T)??M.get(T);V?ee(V,A,u):(c=X(null,w,null,null,A,T,u,v,t,r,!0),M.set(T,c)),b.add(T)}for(const[N,S]of w.items)b.has(N)||I.skipped_effects.add(S.e);I.add_callback(e)}else e();l&&R(!0),E(i)}),D&&(h=k)}function He(d,t,r,o,v,_,h,w,y){var m=t.length,x=r.items,M=r.first,i=M,g,f=null,e=[],a=[],l,s,n,c;for(c=0;c<m;c+=1){if(l=t[c],s=w(l,c),n=x.get(s),n===void 0){var u=o.get(s);if(u!==void 0){o.delete(s),x.set(s,u);var A=f?f.next:i;C(r,f,u),C(r,u,A),P(u,A,v),f=u}else{var T=i?i.e.nodes_start:v;f=X(T,r,f,f===null?r.first:f.next,l,s,c,_,h,y)}x.set(s,f),e=[],a=[],i=f.next;continue}if(ee(n,l,c),(n.e.f&Y)!==0&&j(n.e),n!==i){if(g!==void 0&&g.has(n)){if(e.length<a.length){var b=a[0],I;f=b.prev;var V=e[0],N=e[e.length-1];for(I=0;I<e.length;I+=1)P(e[I],b,v);for(I=0;I<a.length;I+=1)g.delete(a[I]);C(r,V.prev,N.next),C(r,f,V),C(r,N,b),i=b,f=N,c-=1,e=[],a=[]}else g.delete(n),P(n,i,v),C(r,n.prev,n.next),C(r,n,f===null?r.first:f.next),C(r,f,n),f=n;continue}for(e=[],a=[];i!==null&&i.k!==s;)(i.e.f&Y)===0&&(g??=new Set).add(i),a.push(i),i=i.next;if(i===null)continue;n=i}e.push(n),f=n,i=n.next}if(i!==null||g!==void 0){for(var S=g===void 0?[]:Q(g);i!==null;)(i.e.f&Y)===0&&S.push(i),i=i.next;var ae=S.length;if(ae>0){var re=m===0?v:null;qe(r,S,re)}}d.first=r.first&&r.first.e,d.last=f&&f.e;for(var te of o.values())$(te.e);o.clear()}function ee(d,t,r,o){_e(d.v,t),d.i=r}function X(d,t,r,o,v,_,h,w,y,m,x){var M=(y&ye)!==0,i=(y&Ee)===0,g=M?i?ge(v,!1,!1):W(v):v,f=(y&we)===0?h:W(h),e={i:f,v:g,k:_,a:null,e:null,prev:r,next:o};try{if(d===null){var a=document.createDocumentFragment();a.append(d=K())}return e.e=U(()=>w(d,g,f,m),D),e.e.prev=r&&r.e,e.e.next=o&&o.e,r===null?x||(t.first=e):(r.next=e,r.e.next=e.e),o!==null&&(o.prev=e,o.e.prev=e.e),e}finally{}}function P(d,t,r){for(var o=d.next?d.next.e.nodes_start:r,v=t?t.e.nodes_start:r,_=d.e.nodes_start;_!==null&&_!==o;){var h=Te(_);v.before(_),_=h}}function C(d,t,r){t===null?d.first=r:(t.next=r,t.e.next=r&&r.e),r!==null&&(r.prev=t,r.e.prev=t&&t.e)}var Re=p("<div><code> </code></div> <div> </div>",1),Ye=p('<div class="canvas-container svelte-qqyxgz"><!></div> <div class="vector-values svelte-qqyxgz"></div>',1);function Oe(d,t){be(t,!0);let r,o=Ne(1),v=null;const _=(e,a)=>{const l=e.width/2+E(o)*a.x,s=e.height/2-E(o)*a.y;e.strokeWeight(3);try{const n=a.clone().invert().rotateByDeg(45).resize(10);e.line(l,s,l+n.x,s-n.y);const c=a.clone().invert().rotateByDeg(-45).resize(10);e.line(l,s,l+c.x,s-c.y),e.line(e.width/2,e.height/2,l,s)}catch{e.circle(e.width/2,e.height/2,10)}},h=(e,a)=>{e.stroke(125,80),e.strokeWeight(1);for(let l=0;l<a.size/a.graduation;l++){const s=e.width/2+l*E(o)*a.graduation;e.line(s,0,s,e.height);const n=e.width/2-l*E(o)*a.graduation;e.line(n,0,n,e.height);const c=e.height/2+l*E(o)*a.graduation;e.line(0,c,e.width,c);const u=e.height/2-l*E(o)*a.graduation;e.line(0,u,e.width,u)}},w=e=>e.mouseX>=0&&e.mouseY>=0&&e.mouseX<e.width&&e.mouseY<e.height,y=(e,a)=>{Ve(o,e.width/a.size)},m=(e,a)=>new Z(a.x-e.width/2,e.height/2-a.y).divideScalar(E(o)),x=e=>{e.setup=()=>{r=e,e.createCanvas(300,300)},e.draw=()=>{y(e,t.grid),e.background(240,240,240),h(e,t.grid);for(const{vec:a,color:l}of t.vectors)e.stroke(l),_(e,a);if(e.mouseIsPressed&&w(e)){const a=m(e,new Z(e.mouseX,e.mouseY)),l=t.vectors.filter(s=>s.isDraggable);if(v!==null){const s=l[v];s.onUpdate&&s.onUpdate(a)}else for(let s=0;s<l.length;s++){const n=l[s],c=a.distance(n.vec);if(n.onUpdate&&(c<t.grid.graduation/2||l.length===1)){v=s,n.onUpdate(a);break}}}else v=null}};se(()=>{r?.remove()});var M=Ye(),i=F(M),g=z(i);ke(g,{sketch:x}),q(i);var f=G(i,2);ze(f,21,()=>t.vectors,e=>e.name,(e,a)=>{var l=Re(),s=F(l),n=z(s),c=z(n,!0);q(n),q(s);var u=G(s,2),A=z(u,!0);q(u),Se(T=>{J(s,`color: ${E(a).color??""}`),B(c,E(a).name),J(u,`color: ${E(a).color??""}`),B(A,T)},[()=>E(a).vec.toString()]),L(e,l)}),q(f),L(d,M),De()}export{Oe as M};
