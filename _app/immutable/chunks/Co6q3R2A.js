import"./DsnmJJEf.js";import{o as se,a as B}from"./hDrwkfIk.js";import{o as Q,j as ne,m as H,i as D,af as ie,k as le,g as A,a6 as oe,r as fe,H as ue,l as W,n as R,y as q,ag as de,ah as ve,q as Y,v as ce,t as he,ai as _e,O as ge,aj as F,ak as Z,al as me,am as we,w as j,x as xe,an as ye,ao as Ee,ap as O,aq as $,ar as Ae,as as Ie,at as Te,au as Me,a4 as be,p as Ce,f as p,b as L,c as G,d as De,e as J,$ as z,a0 as S,h as ke,s as Ve,_ as Ne}from"./CY1iBhr2.js";import{P as qe,V as P,s as K}from"./DnDkWYNL.js";function Se(v,s,r){for(var l=v.items,c=[],_=s.length,h=0;h<_;h++)Ie(s[h].e,c,!0);var w=_>0&&c.length===0&&r!==null;if(w){var I=r.parentNode;Te(I),I.append(r),l.clear(),b(v,s[0].prev,s[_-1].next)}Me(c,()=>{for(var m=0;m<_;m++){var x=s[m];w||(l.delete(x.k),b(v,x.prev,x.next)),$(x.e,!w)}})}function ze(v,s,r,l,c,_=null){var h=v,w={flags:s,items:new Map,first:null};{var I=v;h=D?H(ie(I)):I.appendChild(Q())}D&&le();var m=null,x=!1,M=new Map,i=oe(()=>{var a=r();return me(a)?a:a==null?[]:Z(a)}),g,o;function e(){He(o,g,w,M,h,c,s,l,r),_!==null&&(g.length===0?m?j(m):m=Y(()=>_(h)):m!==null&&xe(m,()=>{m=null}))}ne(()=>{o??=be,g=A(i);var a=g.length;if(x&&a===0)return;x=a===0;let d=!1;if(D){var n=fe(h)===ue;n!==(a===0)&&(h=W(),H(h),R(!1),d=!0)}if(D){for(var t=null,u,f=0;f<a;f++){if(q.nodeType===de&&q.data===ve){h=q,d=!0,R(!1);break}var E=g[f],y=l(E,f);u=X(q,w,t,null,E,y,f,c,s,r),w.items.set(y,u),t=u}a>0&&H(W())}if(D)a===0&&_&&(m=Y(()=>_(h)));else if(ce()){var C=new Set,T=he;for(f=0;f<a;f+=1){E=g[f],y=l(E,f);var k=w.items.get(y)??M.get(y);k?ee(k,E,f):(u=X(null,w,null,null,E,y,f,c,s,r,!0),M.set(y,u)),C.add(y)}for(const[V,N]of w.items)C.has(V)||T.skipped_effects.add(N.e);T.add_callback(e)}else e();d&&R(!0),A(i)}),D&&(h=q)}function He(v,s,r,l,c,_,h,w,I){var m=s.length,x=r.items,M=r.first,i=M,g,o=null,e=[],a=[],d,n,t,u;for(u=0;u<m;u+=1){if(d=s[u],n=w(d,u),t=x.get(n),t===void 0){var f=l.get(n);if(f!==void 0){l.delete(n),x.set(n,f);var E=o?o.next:i;b(r,o,f),b(r,f,E),U(f,E,c),o=f}else{var y=i?i.e.nodes_start:c;o=X(y,r,o,o===null?r.first:o.next,d,n,u,_,h,I)}x.set(n,o),e=[],a=[],i=o.next;continue}if(ee(t,d,u),(t.e.f&O)!==0&&j(t.e),t!==i){if(g!==void 0&&g.has(t)){if(e.length<a.length){var C=a[0],T;o=C.prev;var k=e[0],V=e[e.length-1];for(T=0;T<e.length;T+=1)U(e[T],C,c);for(T=0;T<a.length;T+=1)g.delete(a[T]);b(r,k.prev,V.next),b(r,o,k),b(r,V,C),i=C,o=V,u-=1,e=[],a=[]}else g.delete(t),U(t,i,c),b(r,t.prev,t.next),b(r,t,o===null?r.first:o.next),b(r,o,t),o=t;continue}for(e=[],a=[];i!==null&&i.k!==n;)(i.e.f&O)===0&&(g??=new Set).add(i),a.push(i),i=i.next;if(i===null)continue;t=i}e.push(t),o=t,i=t.next}if(i!==null||g!==void 0){for(var N=g===void 0?[]:Z(g);i!==null;)(i.e.f&O)===0&&N.push(i),i=i.next;var ae=N.length;if(ae>0){var re=m===0?c:null;Se(r,N,re)}}v.first=r.first&&r.first.e,v.last=o&&o.e;for(var te of l.values())$(te.e);l.clear()}function ee(v,s,r,l){_e(v.v,s),v.i=r}function X(v,s,r,l,c,_,h,w,I,m,x){var M=(I&ye)!==0,i=(I&Ee)===0,g=M?i?ge(c,!1,!1):F(c):c,o=(I&we)===0?h:F(h),e={i:o,v:g,k:_,a:null,e:null,prev:r,next:l};try{if(v===null){var a=document.createDocumentFragment();a.append(v=Q())}return e.e=Y(()=>w(v,g,o,m),D),e.e.prev=r&&r.e,e.e.next=l&&l.e,r===null?x||(s.first=e):(r.next=e,r.e.next=e.e),l!==null&&(l.prev=e,l.e.prev=e.e),e}finally{}}function U(v,s,r){for(var l=v.next?v.next.e.nodes_start:r,c=s?s.e.nodes_start:r,_=v.e.nodes_start;_!==null&&_!==l;){var h=Ae(_);c.before(_),_=h}}function b(v,s,r){s===null?v.first=r:(s.next=r,s.e.next=r&&r.e),r!==null&&(r.prev=s,r.e.prev=s&&s.e)}var Re=p("<div><code> </code></div> <div> </div>",1),Oe=p('<div class="canvas-container svelte-qqyxgz"><!></div> <div class="vector-values svelte-qqyxgz"></div>',1);function Be(v,s){Ce(s,!0);let r,l=Ve(1),c=null;const _=(e,a,d,n)=>{const t=e.width/2+A(l)*a.x,u=e.height/2-A(l)*a.y;try{if(n){e.strokeWeight(1),e.stroke(0,50),e.noFill();const y=new P(t,u);e.circle(y.x,y.y,s.grid.graduation*A(l))}e.stroke(d),e.strokeWeight(n?4:2);const f=a.clone().invert().rotateByDeg(45).resize(10);e.line(t,u,t+f.x,u-f.y);const E=a.clone().invert().rotateByDeg(-45).resize(10);e.line(t,u,t+E.x,u-E.y),e.line(e.width/2,e.height/2,t,u)}catch{e.circle(e.width/2,e.height/2,10)}},h=(e,a)=>{e.stroke(125,80),e.strokeWeight(1);for(let d=0;d<a.size/a.graduation;d++){const n=e.width/2+d*A(l)*a.graduation;e.line(n,0,n,e.height);const t=e.width/2-d*A(l)*a.graduation;e.line(t,0,t,e.height);const u=e.height/2+d*A(l)*a.graduation;e.line(0,u,e.width,u);const f=e.height/2-d*A(l)*a.graduation;e.line(0,f,e.width,f)}},w=e=>e.mouseX>=0&&e.mouseY>=0&&e.mouseX<e.width&&e.mouseY<e.height,I=(e,a)=>{ke(l,e.width/a.size)},m=(e,a)=>new P(a.x-e.width/2,e.height/2-a.y).divideScalar(A(l)),x=e=>{e.setup=()=>{r=e,e.createCanvas(300,300)},e.draw=()=>{I(e,s.grid),e.background(240,240,240),h(e,s.grid);for(const{vec:a,color:d,isDraggable:n}of s.vectors)_(e,a,d,n);if(e.mouseIsPressed&&w(e)){const a=m(e,new P(e.mouseX,e.mouseY)),d=s.vectors.filter(n=>n.isDraggable);if(c!==null){const n=d[c];n.onUpdate&&n.onUpdate(a)}else for(let n=0;n<d.length;n++){const t=d[n],u=a.distance(t.vec);if(t.onUpdate&&(u<s.grid.graduation/2||d.length===1)){c=n,t.onUpdate(a);break}}}else c=null}};se(()=>{r?.remove()});var M=Oe(),i=L(M),g=z(i);qe(g,{sketch:x}),S(i);var o=J(i,2);ze(o,21,()=>s.vectors,e=>e.name,(e,a)=>{var d=Re(),n=L(d),t=z(n),u=z(t,!0);S(t),S(n);var f=J(n,2),E=z(f,!0);S(f),Ne(y=>{K(n,`color: ${A(a).color??""}`),B(u,A(a).name),K(f,`color: ${A(a).color??""}`),B(E,y)},[()=>A(a).vec.toString()]),G(e,d)}),S(o),G(v,M),De()}export{Be as M,ze as e};
