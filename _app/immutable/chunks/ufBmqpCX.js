import"./DsnmJJEf.js";import{o as se,a as X}from"./BenD77kU.js";import{o as Q,j as ne,m as H,i as D,af as ie,k as le,g as E,a6 as oe,r as fe,H as ue,l as B,n as R,y as q,ag as ve,ah as de,q as U,v as ce,t as he,ai as _e,O as ge,aj as L,ak as Z,al as me,am as we,w as j,x as xe,an as ye,ao as Ee,ap as O,aq as $,ar as Ae,as as Ie,at as Te,au as Me,a4 as be,p as Ce,f as p,b as W,c as F,d as De,e as G,$ as z,a0 as S,h as Ne,s as Ve,_ as ke}from"./DN2LkAR_.js";import{P as qe,V as J,s as K}from"./Gnf6quZY.js";function Se(v,t,r){for(var o=v.items,d=[],_=t.length,h=0;h<_;h++)Ie(t[h].e,d,!0);var w=_>0&&d.length===0&&r!==null;if(w){var y=r.parentNode;Te(y),y.append(r),o.clear(),b(v,t[0].prev,t[_-1].next)}Me(d,()=>{for(var m=0;m<_;m++){var x=t[m];w||(o.delete(x.k),b(v,x.prev,x.next)),$(x.e,!w)}})}function ze(v,t,r,o,d,_=null){var h=v,w={flags:t,items:new Map,first:null};{var y=v;h=D?H(ie(y)):y.appendChild(Q())}D&&le();var m=null,x=!1,M=new Map,i=oe(()=>{var a=r();return me(a)?a:a==null?[]:Z(a)}),g,f;function e(){He(f,g,w,M,h,d,t,o,r),_!==null&&(g.length===0?m?j(m):m=U(()=>_(h)):m!==null&&xe(m,()=>{m=null}))}ne(()=>{f??=be,g=E(i);var a=g.length;if(x&&a===0)return;x=a===0;let l=!1;if(D){var s=fe(h)===ue;s!==(a===0)&&(h=B(),H(h),R(!1),l=!0)}if(D){for(var n=null,c,u=0;u<a;u++){if(q.nodeType===ve&&q.data===de){h=q,l=!0,R(!1);break}var I=g[u],A=o(I,u);c=Y(q,w,n,null,I,A,u,d,t,r),w.items.set(A,c),n=c}a>0&&H(B())}if(D)a===0&&_&&(m=U(()=>_(h)));else if(ce()){var C=new Set,T=he;for(u=0;u<a;u+=1){I=g[u],A=o(I,u);var N=w.items.get(A)??M.get(A);N?ee(N,I,u):(c=Y(null,w,null,null,I,A,u,d,t,r,!0),M.set(A,c)),C.add(A)}for(const[V,k]of w.items)C.has(V)||T.skipped_effects.add(k.e);T.add_callback(e)}else e();l&&R(!0),E(i)}),D&&(h=q)}function He(v,t,r,o,d,_,h,w,y){var m=t.length,x=r.items,M=r.first,i=M,g,f=null,e=[],a=[],l,s,n,c;for(c=0;c<m;c+=1){if(l=t[c],s=w(l,c),n=x.get(s),n===void 0){var u=o.get(s);if(u!==void 0){o.delete(s),x.set(s,u);var I=f?f.next:i;b(r,f,u),b(r,u,I),P(u,I,d),f=u}else{var A=i?i.e.nodes_start:d;f=Y(A,r,f,f===null?r.first:f.next,l,s,c,_,h,y)}x.set(s,f),e=[],a=[],i=f.next;continue}if(ee(n,l,c),(n.e.f&O)!==0&&j(n.e),n!==i){if(g!==void 0&&g.has(n)){if(e.length<a.length){var C=a[0],T;f=C.prev;var N=e[0],V=e[e.length-1];for(T=0;T<e.length;T+=1)P(e[T],C,d);for(T=0;T<a.length;T+=1)g.delete(a[T]);b(r,N.prev,V.next),b(r,f,N),b(r,V,C),i=C,f=V,c-=1,e=[],a=[]}else g.delete(n),P(n,i,d),b(r,n.prev,n.next),b(r,n,f===null?r.first:f.next),b(r,f,n),f=n;continue}for(e=[],a=[];i!==null&&i.k!==s;)(i.e.f&O)===0&&(g??=new Set).add(i),a.push(i),i=i.next;if(i===null)continue;n=i}e.push(n),f=n,i=n.next}if(i!==null||g!==void 0){for(var k=g===void 0?[]:Z(g);i!==null;)(i.e.f&O)===0&&k.push(i),i=i.next;var ae=k.length;if(ae>0){var re=m===0?d:null;Se(r,k,re)}}v.first=r.first&&r.first.e,v.last=f&&f.e;for(var te of o.values())$(te.e);o.clear()}function ee(v,t,r,o){_e(v.v,t),v.i=r}function Y(v,t,r,o,d,_,h,w,y,m,x){var M=(y&ye)!==0,i=(y&Ee)===0,g=M?i?ge(d,!1,!1):L(d):d,f=(y&we)===0?h:L(h),e={i:f,v:g,k:_,a:null,e:null,prev:r,next:o};try{if(v===null){var a=document.createDocumentFragment();a.append(v=Q())}return e.e=U(()=>w(v,g,f,m),D),e.e.prev=r&&r.e,e.e.next=o&&o.e,r===null?x||(t.first=e):(r.next=e,r.e.next=e.e),o!==null&&(o.prev=e,o.e.prev=e.e),e}finally{}}function P(v,t,r){for(var o=v.next?v.next.e.nodes_start:r,d=t?t.e.nodes_start:r,_=v.e.nodes_start;_!==null&&_!==o;){var h=Ae(_);d.before(_),_=h}}function b(v,t,r){t===null?v.first=r:(t.next=r,t.e.next=r&&r.e),r!==null&&(r.prev=t,r.e.prev=t&&t.e)}var Re=p("<div><code> </code></div> <div> </div>",1),Oe=p('<div class="canvas-container svelte-qqyxgz"><!></div> <div class="vector-values svelte-qqyxgz"></div>',1);function Be(v,t){Ce(t,!0);let r,o=Ve(1),d=null;const _=(e,a)=>{const l=e.width/2+E(o)*a.x,s=e.height/2-E(o)*a.y;e.strokeWeight(3);try{const n=a.clone().invert().rotateByDeg(45).resize(10);e.line(l,s,l+n.x,s-n.y);const c=a.clone().invert().rotateByDeg(-45).resize(10);e.line(l,s,l+c.x,s-c.y),e.line(e.width/2,e.height/2,l,s)}catch{e.circle(e.width/2,e.height/2,10)}},h=(e,a)=>{e.stroke(125,80),e.strokeWeight(1);for(let l=0;l<a.size/a.graduation;l++){const s=e.width/2+l*E(o)*a.graduation;e.line(s,0,s,e.height);const n=e.width/2-l*E(o)*a.graduation;e.line(n,0,n,e.height);const c=e.height/2+l*E(o)*a.graduation;e.line(0,c,e.width,c);const u=e.height/2-l*E(o)*a.graduation;e.line(0,u,e.width,u)}},w=e=>e.mouseX>=0&&e.mouseY>=0&&e.mouseX<e.width&&e.mouseY<e.height,y=(e,a)=>{Ne(o,e.width/a.size)},m=(e,a)=>new J(a.x-e.width/2,e.height/2-a.y).divideScalar(E(o)),x=e=>{e.setup=()=>{r=e,e.createCanvas(300,300)},e.draw=()=>{y(e,t.grid),e.background(240,240,240),h(e,t.grid);for(const{vec:a,color:l}of t.vectors)e.stroke(l),_(e,a);if(e.mouseIsPressed&&w(e)){const a=m(e,new J(e.mouseX,e.mouseY)),l=t.vectors.filter(s=>s.isDraggable);if(d!==null){const s=l[d];s.onUpdate&&s.onUpdate(a)}else for(let s=0;s<l.length;s++){const n=l[s],c=a.distance(n.vec);if(n.onUpdate&&(c<t.grid.graduation/2||l.length===1)){d=s,n.onUpdate(a);break}}}else d=null}};se(()=>{r?.remove()});var M=Oe(),i=W(M),g=z(i);qe(g,{sketch:x}),S(i);var f=G(i,2);ze(f,21,()=>t.vectors,e=>e.name,(e,a)=>{var l=Re(),s=W(l),n=z(s),c=z(n,!0);S(n),S(s);var u=G(s,2),I=z(u,!0);S(u),ke(A=>{K(s,`color: ${E(a).color??""}`),X(c,E(a).name),K(u,`color: ${E(a).color??""}`),X(I,A)},[()=>E(a).vec.toString()]),F(e,l)}),S(f),F(v,M),De()}export{Be as M,ze as e};
