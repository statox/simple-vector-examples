import"./DsnmJJEf.js";import{o as se,a as O}from"./CVJGeIlM.js";import{e as K,b as ne,s as R,h as D,af as ie,a as le,C as E,a6 as oe,r as ue,H as fe,c as W,d as Y,k,ag as de,ah as ve,f as z,i as ce,g as he,ai as _e,B as ge,aj as q,ak as Q,al as me,am as we,j,p as xe,an as ye,ao as Ee,ap as P,aq as $,ar as Te,as as Ae,at as Ie,au as Me,a4 as Ce,S as be,l as p,V as F,m as L,X as De,T as G,Z as H,F as Ve,_ as Ne,Y as U,W as Se}from"./DPwOY9Ev.js";import{P as ke,V as Z,s as J}from"./COKwq80w.js";function He(u,s,r){for(var o=u.items,f=[],c=s.length,v=0;v<c;v++)Ae(s[v].e,f,!0);var w=c>0&&f.length===0&&r!==null;if(w){var y=r.parentNode;Ie(y),y.append(r),o.clear(),C(u,s[0].prev,s[c-1].next)}Me(f,()=>{for(var m=0;m<c;m++){var x=s[m];w||(o.delete(x.k),C(u,x.prev,x.next)),$(x.e,!w)}})}function Re(u,s,r,o,f,c=null){var v=u,w={flags:s,items:new Map,first:null};{var y=u;v=D?R(ie(y)):y.appendChild(K())}D&&le();var m=null,x=!1,I=new Map,i=oe(()=>{var t=r();return me(t)?t:t==null?[]:Q(t)}),h,e;function a(){Ye(e,h,w,I,v,f,s,o,r),c!==null&&(h.length===0?m?j(m):m=z(()=>c(v)):m!==null&&xe(m,()=>{m=null}))}ne(()=>{e??=Ce,h=E(i);var t=h.length;if(x&&t===0)return;x=t===0;let n=!1;if(D){var d=ue(v)===fe;d!==(t===0)&&(v=W(),R(v),Y(!1),n=!0)}if(D){for(var l=null,_,g=0;g<t;g++){if(k.nodeType===de&&k.data===ve){v=k,n=!0,Y(!1);break}var T=h[g],M=o(T,g);_=B(k,w,l,null,T,M,g,f,s,r),w.items.set(M,_),l=_}t>0&&R(W())}if(D)t===0&&c&&(m=z(()=>c(v)));else if(ce()){var b=new Set,A=he;for(g=0;g<t;g+=1){T=h[g],M=o(T,g);var V=w.items.get(M)??I.get(M);V?ee(V,T,g):(_=B(null,w,null,null,T,M,g,f,s,r,!0),I.set(M,_)),b.add(M)}for(const[N,S]of w.items)b.has(N)||A.skipped_effects.add(S.e);A.add_callback(a)}else a();n&&Y(!0),E(i)}),D&&(v=k)}function Ye(u,s,r,o,f,c,v,w,y){var m=s.length,x=r.items,I=r.first,i=I,h,e=null,a=[],t=[],n,d,l,_;for(_=0;_<m;_+=1){if(n=s[_],d=w(n,_),l=x.get(d),l===void 0){var g=o.get(d);if(g!==void 0){o.delete(d),x.set(d,g);var T=e?e.next:i;C(r,e,g),C(r,g,T),X(g,T,f),e=g}else{var M=i?i.e.nodes_start:f;e=B(M,r,e,e===null?r.first:e.next,n,d,_,c,v,y)}x.set(d,e),a=[],t=[],i=e.next;continue}if(ee(l,n,_),(l.e.f&P)!==0&&j(l.e),l!==i){if(h!==void 0&&h.has(l)){if(a.length<t.length){var b=t[0],A;e=b.prev;var V=a[0],N=a[a.length-1];for(A=0;A<a.length;A+=1)X(a[A],b,f);for(A=0;A<t.length;A+=1)h.delete(t[A]);C(r,V.prev,N.next),C(r,e,V),C(r,N,b),i=b,e=N,_-=1,a=[],t=[]}else h.delete(l),X(l,i,f),C(r,l.prev,l.next),C(r,l,e===null?r.first:e.next),C(r,e,l),e=l;continue}for(a=[],t=[];i!==null&&i.k!==d;)(i.e.f&P)===0&&(h??=new Set).add(i),t.push(i),i=i.next;if(i===null)continue;l=i}a.push(l),e=l,i=l.next}if(i!==null||h!==void 0){for(var S=h===void 0?[]:Q(h);i!==null;)(i.e.f&P)===0&&S.push(i),i=i.next;var ae=S.length;if(ae>0){var re=m===0?f:null;He(r,S,re)}}u.first=r.first&&r.first.e,u.last=e&&e.e;for(var te of o.values())$(te.e);o.clear()}function ee(u,s,r,o){_e(u.v,s),u.i=r}function B(u,s,r,o,f,c,v,w,y,m,x){var I=(y&ye)!==0,i=(y&Ee)===0,h=I?i?ge(f,!1,!1):q(f):f,e=(y&we)===0?v:q(v),a={i:e,v:h,k:c,a:null,e:null,prev:r,next:o};try{if(u===null){var t=document.createDocumentFragment();t.append(u=K())}return a.e=z(()=>w(u,h,e,m),D),a.e.prev=r&&r.e,a.e.next=o&&o.e,r===null?x||(s.first=a):(r.next=a,r.e.next=a.e),o!==null&&(o.prev=a,o.e.prev=a.e),a}finally{}}function X(u,s,r){for(var o=u.next?u.next.e.nodes_start:r,f=s?s.e.nodes_start:r,c=u.e.nodes_start;c!==null&&c!==o;){var v=Te(c);f.before(c),c=v}}function C(u,s,r){s===null?u.first=r:(s.next=r,s.e.next=r&&r.e),r!==null&&(r.prev=s,r.e.prev=s&&s.e)}var Pe=p("<div><code> </code></div> <div> </div>",1),Ue=p('<!> <div class="vector-values svelte-1r2uwu0"></div>',1);function We(u,s){be(s,!0);let r,o=Ne(1),f=null;const c=(e,a)=>{const t=e.width/2+E(o)*a.x,n=e.height/2-E(o)*a.y;e.strokeWeight(3);try{const d=a.clone().invert().rotateByDeg(45).resize(10);e.line(t,n,t+d.x,n-d.y);const l=a.clone().invert().rotateByDeg(-45).resize(10);e.line(t,n,t+l.x,n-l.y),e.line(e.width/2,e.height/2,t,n)}catch{e.circle(e.width/2,e.height/2,10)}},v=(e,a)=>{e.stroke(125,80),e.strokeWeight(1);for(let t=0;t<a.size/a.graduation;t++){const n=e.width/2+t*E(o)*a.graduation;e.line(n,0,n,e.height);const d=e.width/2-t*E(o)*a.graduation;e.line(d,0,d,e.height);const l=e.height/2+t*E(o)*a.graduation;e.line(0,l,e.width,l);const _=e.height/2-t*E(o)*a.graduation;e.line(0,_,e.width,_)}},w=e=>e.mouseX>=0&&e.mouseY>=0&&e.mouseX<e.width&&e.mouseY<e.height,y=(e,a)=>{Ve(o,e.width/a.size)},m=(e,a)=>new Z(a.x-e.width/2,e.height/2-a.y).divideScalar(E(o)),x=e=>{e.setup=()=>{r=e,e.createCanvas(300,300)},e.draw=()=>{y(e,s.grid),e.background(240,240,240),v(e,s.grid);for(const{vec:a,color:t}of s.vectors)e.stroke(t),c(e,a);if(e.mouseIsPressed&&w(e)){const a=m(e,new Z(e.mouseX,e.mouseY)),t=s.vectors.filter(n=>n.isDraggable);if(f!==null){const n=t[f];n.onUpdate&&n.onUpdate(a)}else for(let n=0;n<t.length;n++){const d=t[n],l=a.distance(d.vec);if(d.onUpdate&&(l<s.grid.graduation/2||t.length===1)){f=n,d.onUpdate(a);break}}}else f=null}};se(()=>{r?.remove()});var I=Ue(),i=F(I);ke(i,{sketch:x});var h=G(i,2);Re(h,21,()=>s.vectors,e=>e.name,(e,a)=>{var t=Pe(),n=F(t),d=U(n),l=U(d,!0);H(d),H(n);var _=G(n,2),g=U(_,!0);H(_),Se(T=>{J(n,`color: ${E(a).color??""}`),O(l,E(a).name),J(_,`color: ${E(a).color??""}`),O(g,T)},[()=>E(a).vec.toString()]),L(e,t)}),H(h),L(u,I),De()}export{We as M};
